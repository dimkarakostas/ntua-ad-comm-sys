Εργαστηριακή άσκηση 4
Καρακώστας Δημήτριος
ΑΜ: 03110179

1. Παρατηρώ ότι οι κρουστικές που οφείλονται στο υψίσυχνο ημίτονο δεν εμφανίζονται στο διάγραμμα που προέκυψε
μετά από τη χρήση της decimate. Αυτό οφείλεται στο ότι η decimate υλοποιεί επιπλέον, σε σχέση με την
downsample, φιλτράρισμα του σήματος που προκύπτει με φίλτρο συχνότητας αποκοπής Fs/2*M, όπου Fs η συχνότητα
δειγματοληψίας του αρχικού σήματος και Μ ο παράγοντας της αραίωσης. Στην περίπτωση το σήμα αποτελείται από
δύο κρουστικές μία στα 30Hz και μια στα 300Hz. Η συχνότητα δειγματοληψίας είναι 1ΚHz και Μ=4, άρα το
φίλτρο θα αποκόπτει στα 125Hz. Μετά την downsample οι κρουστικές μετατοπίζονται στα 120Hz και 200Hz
αντίστοιχα. Έτσι το υψίσυχνο σήμα αποκόπτεται.

2. Στο διάγραμμα που προκύπτει από την upsample παρατηρούμε περιοδική επανάληψη του σήματος κάθε 250Hz που
αντιστοιχεί στο υποτετραπλάσιο της συχνότητας δειγματοληψίας. Αντίθετα στο διάγραμμα της interp οι περιοδικές
επαναλήψεις έχουν κοπεί σφού όμοια με πριν εφαρμόστηκε φίλτρο με αποκοπή στα 125Hz. Επιπλέον παρατηρούμε ότι
ενώ εξ' αιτίας του scaling το πλάτος των κρουστικών μετά την upsample μειώθηκε, στο διάγραμμα της interp το
ύψος των κρουστικών έχει επανέλθει, καθώς το φίλτρο που εφαρμόζει η interp έχει κέρδος L, όπου L ο παράγοντας
της πύκνωσης (εδώ L=4).

3. Στην εφαρμογή αυτή πραγματοποιούμε υποδειγματοληψία κατά έναν παράγοντα Μ=8. Το αρχικό σήμα έχει
κρουστικές στις συχνότητες 108Hz και 110Hz. Μετά την εφαρμογή της decimate οι κρουστικές στον άξονα κανονικοποιημένης
συχνότητας εμφανίζονται στα 12Hz και 14Hz αντίστοιχα. Το φαινόμενο εξηγείται ως εξής:
Η συχνότητα δειγματοληψίας είναι 256Hz. Θεωρούμε την περιοδική επέκταση του σήματος που προέκυψε από τη
διαδικασία της δειγματοληψίας γύρω από συχνότητες που είναι ακέραια πολλαπλάσια της συχνότητας δειγματοληψίας.
Προκειμένουυ να πάρουμε το φάσμα του υποδειγματοληπτημένου σήματος (αφού κανονικοποιήσουμε τον άξονα των
συχνοτήτων διαιρόντας κατά 8) πρέπει να εφαρμόσουμε τη συνάρτηση χτένι και να αθροίσουμε 8 μετατοπισμένες εκδοχές
του σήματος, κάθε φορά κατά Fs/M=32. Παρατηρούμε ότι μετά από 5 μετατοπίσεις οι κρουστικές που βρισκόντουσαν δεξιά
του -256 έχουν έρθει στα 12 και 14 Hz (και αυτές που ήταν αριστερά του στα -12 και -14 αντίστοιχα). Το φίλτρο της
decimation θα κόψει στα Fs/2*M=256/16=16Hz και έτσι θα μείνουν μόνο αυτές οι 2 κρουστικές.

4. Η εν λόγω συνέλιξη στην ουσία πραγματοποιεί το βαθυπερατό φιλτράρισμα, για να κρατήσουμε μόνο το
βαθυπερατό κομμάτι της διαμόρφωσης. Ωστόσο, εφόσον βαθυπερατό φιλτράρισμα πραγματοποιεί και η interp, μπορεί
να αντικαταστήσει το βαθυπερατό φίλτρο.


5. Δεν χρειάζονται οι εντολές κατασκευής του βαθυπερατού φίλτρου και της κρουστικής του απόκρισης:

order=256;hpm=firpm(order, [0 F1 F2 0.5]*2, [1 1 0 0]);
[H,F]=freqz(hpm,1,512,Fs);
figure;subplot(2,1,1);plot(F,20*log(abs(H)));grid;
title('Αποκριση συχνότητας βαθυπερατού φίλτρου');
subplot(2,1,2);plot(F,phase(H));grid;

Δεν χρειάζονται οι συνελίξεις με την κρουστική του φίλτρου, όπως εξηγήθηκε παραπάνω, καθώς και οι εντολές
που τις ακολουθούν για επαναφορά του μήκους του σήματος στο μήκος που είχε πριν τη συνέλιξη:

s=conv(s_dense,hpm); s=s(order/2+(1:length(s_dense)));

s_dsb_lp=conv(s_dsb_dm,hpm);
s_dsb_lp=s_dsb_lp(order/2+(1:length(s_dsb)));

Τέλος, δεν χρειάζονται οι upsample kai downsample, αφού οι interp και decimate τις υπερκαλύπτουν:

s_dense=4*upsample(sima_lp,4);Fs=Fs*4;
s_dsb_lp=downsample(s_dsb_lp,4); Fs=Fs/4;

6. Εφόσον η διαμόρφωση ΔΕΝ γίνεται με καταπιεσμένο το φέρον, ακόμα και μετά την αποδιαμόρφωση παραμένει η DC
συνιστώσα, καθώς στο πεδίο της συχνότητας είναι στο 0 και άρα το βαθυπερατό φίλτρο δεν την αποκόπτει.
Προκειμένου να απαλλαγούμε από τη DC συνιστώσα αφαιρούμε από το αποδιαμορφωμένο σήμα τη μέση τιμή του.
